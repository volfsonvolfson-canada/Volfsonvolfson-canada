<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="color-scheme" content="light dark">
  <title>Retreats and Workshops — Back to Base</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <script>
    // UNIVERSAL THEME INITIALIZATION - Works on ALL pages
    (function() {
      'use strict';
      try {
        const savedTheme = localStorage.getItem('btb_theme');
        const userSetTheme = localStorage.getItem('btb_theme_user') === '1';
        let initialTheme = 'dark';
        if (userSetTheme && savedTheme && (savedTheme === 'dark' || savedTheme === 'light' || savedTheme === 'twilight')) {
          initialTheme = savedTheme;
        }
        document.documentElement.setAttribute('data-theme', initialTheme);
      } catch (error) {
        document.documentElement.setAttribute('data-theme', 'dark');
      }
    })();
    
    // Load and update retreat content from localStorage immediately (synchronous)
    (function() {
      'use strict';
      const storedContent = localStorage.getItem('btb_retreat_workshop_content');
      if (storedContent) {
        try {
          const content = JSON.parse(storedContent);
          // Update hero section immediately
          const heroTitle = document.querySelector('.retreat-hero-title');
          const heroSubtitle = document.querySelector('.retreat-hero-subtitle');
          if (heroTitle && content.retreatHeroTitle) heroTitle.textContent = content.retreatHeroTitle;
          if (heroSubtitle && content.retreatHeroSubtitle) heroSubtitle.textContent = content.retreatHeroSubtitle;
        } catch (e) {
          console.error('Failed to parse stored retreat content:', e);
        }
      }
    })();
  </script>
  <link rel="stylesheet" href="styles.css">
  <style>
    /* Retreat and Workshop page specific styles */
    .retreat-hero {
      position: relative;
      height: 60vh;
      min-height: 400px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: url('assets/retreat-hero.jpg') center/cover,
                  url('assets/retreat-hero.jpeg') center/cover,
                  url('assets/retreat-hero.JPG') center/cover,
                  url('https://images.unsplash.com/photo-1544367567-0f2fcb009e0b?q=80&w=1600&auto=format&fit=crop') center/cover;
      background-size: cover;
      background-position: center;
      color: white;
      text-align: center;
      margin-bottom: 0;
    }
    .retreat-hero::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      z-index: 1;
    }
    .retreat-hero .container {
      position: relative;
      z-index: 2;
      display: flex;
      justify-content: center;
      align-items: center;
      width: 100%;
      max-width: 100%;
    }
    .retreat-hero-content {
      max-width: 800px;
      padding: 0 20px;
      text-align: center;
      width: 100%;
    }
    .retreat-hero h1 {
      font-size: clamp(2.5rem, 5vw, 4rem);
      margin-bottom: 1rem;
      color: white !important;
      text-shadow: 0 2px 10px rgba(0,0,0,0.8);
    }
    [data-theme="twilight"] .retreat-hero h1 {
      color: #d4b86e !important;
    }
    .retreat-hero p {
      font-size: clamp(1.1rem, 2vw, 1.5rem);
      opacity: 0.95;
      color: white !important;
      text-shadow: 0 1px 5px rgba(0,0,0,0.8);
    }

    .retreat-section {
      padding: 80px 0;
    }
    .retreat-section:first-of-type {
      padding-bottom: 40px;
    }
    .retreat-section.alt {
      background: var(--bg-alt);
      padding-top: 40px;
    }

    .retreat-section h2 {
      font-size: 2.5rem;
      margin-bottom: 80px;
      color: var(--text);
    }
    [data-theme="twilight"] .retreat-section h2 {
      color: #d4b86e;
    }
    .retreat-section h3 {
      font-size: 2rem;
      margin-bottom: 15px;
      color: var(--text);
    }
    [data-theme="twilight"] .retreat-section h3 {
      color: #d4b86e;
    }
    .retreat-section p {
      font-size: 1.1rem;
      line-height: 1.8;
      color: var(--text-muted);
      margin-bottom: 20px;
    }

    .intro-section {
      max-width: 900px;
      margin: 0 auto;
      text-align: left;
    }
    .intro-section p {
      font-size: 1.2rem;
      line-height: 2;
    }

    .space-card {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 60px;
      align-items: center;
      margin-bottom: 60px;
    }
    .space-card.reverse {
      direction: rtl;
    }
    .space-card.reverse > * {
      direction: ltr;
    }
    .space-image-wrapper {
      position: relative;
      cursor: pointer;
      border-radius: 16px;
      overflow: hidden;
    }
    .space-image {
      width: 100%;
      border-radius: 16px;
      object-fit: cover;
      aspect-ratio: 4/3;
      box-shadow: 0 10px 40px rgba(0,0,0,0.2);
      transition: transform 0.3s ease, opacity 0.3s ease;
      display: block;
    }
    .space-image-wrapper:hover .space-image {
      transform: scale(1.02);
      opacity: 0.9;
    }
    .space-image-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.3);
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity 0.3s ease;
      border-radius: 16px;
    }
    .space-image-wrapper:hover .space-image-overlay {
      opacity: 1;
    }
    .space-image-overlay-icon {
      width: 60px;
      height: 60px;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text);
      font-size: 24px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }
    .space-image-overlay-icon img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }
    .space-content h3 {
      margin-top: 0;
    }
    [data-theme="twilight"] .space-content h2,
    [data-theme="twilight"] .space-content h3 {
      color: #d4b86e;
    }
    .space-content ul {
      list-style: none;
      padding: 0;
      margin: 20px 0;
    }
    .space-content li {
      padding: 10px 0;
      padding-left: 25px;
      position: relative;
      color: var(--text-muted);
    }
    .space-content li:before {
      content: "✓";
      position: absolute;
      left: 0;
      color: var(--text);
      font-weight: bold;
    }

    .workshops-list {
      list-style: none;
      padding: 0;
      margin: 40px 0;
    }
    .workshops-list li {
      padding: 6px 0;
      padding-left: 25px;
      position: relative;
      color: var(--text-muted);
      line-height: 1.5;
      font-size: 1.1rem;
    }
    .workshops-list li:before {
      content: "✓";
      position: absolute;
      left: 0;
      color: var(--text);
      font-weight: bold;
    }
    .collaboration-section .workshops-list li {
      color: rgba(255, 255, 255, 0.9);
    }
    .collaboration-section .workshops-list li:before {
      color: white;
    }

    .contact-form-wrapper {
      flex: 1;
      min-width: 0;
    }
    .contact-form {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }
    .form-group {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }
    .form-group label {
      font-weight: 600;
      font-size: 14px;
      color: var(--text);
    }
    .form-input {
      padding: 10px;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: var(--bg);
      color: var(--text);
      font-size: 14px;
      font-family: inherit;
      transition: border-color 0.3s ease;
    }
    .form-input:focus {
      outline: none;
      border-color: var(--brand);
      box-shadow: 0 0 0 3px rgba(44, 123, 229, 0.1);
    }
    .form-input:invalid:not(:placeholder-shown) {
      border-color: #ff4d4d;
    }
    .contact-submit-btn {
      width: 100%;
      margin-top: 10px;
    }
    .form-message {
      margin-top: 15px;
      padding: 12px;
      border-radius: 8px;
      font-size: 14px;
      display: none;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    .form-message.success,
    .form-message.error {
      display: block;
      opacity: 1;
    }
    .form-message.success {
      background: rgba(34, 197, 94, 0.1);
      color: #22c55e;
      border: 1px solid rgba(34, 197, 94, 0.3);
    }
    .form-message.error {
      background: rgba(239, 68, 68, 0.1);
      color: #ef4444;
      border: 1px solid rgba(239, 68, 68, 0.3);
    }
    .field-error {
      color: #ef4444;
      font-size: 12px;
      display: none;
    }
    .field-error.show {
      display: block;
    }
    .organizer-learn-more {
      text-align: center;
      padding: 0;
    }
    .organizer-learn-more h3 {
      font-size: 1.3rem;
      margin-bottom: 20px;
      color: var(--text);
    }
    [data-theme="twilight"] .organizer-learn-more h3 {
      color: #d4b86e;
    }
    .learn-more-btn {
      background: var(--brand);
      color: white;
      border: none;
      padding: 12px 30px;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.3s ease, transform 0.2s ease;
    }
    .learn-more-btn:hover {
      background: var(--brand-600);
      transform: translateY(-2px);
    }
    .learn-more-btn.active {
      background: var(--brand-600);
    }
    #workshops-section {
      animation: slideDown 0.5s ease;
    }
    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    @media (max-width: 768px) {
      .contact-section-grid {
        grid-template-columns: 1fr;
      }
      .contact-form-wrapper {
        border-left: none;
        border-top: 1px solid var(--border);
        padding-top: 30px;
      }
    }

    .collaboration-section {
      background: var(--brand);
      padding: 80px 0;
      color: white;
    }
    .collaboration-section h2,
    .collaboration-section h3 {
      color: white;
    }
    .collaboration-section p {
      color: rgba(255,255,255,0.9);
    }
    .collaboration-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-top: 40px;
    }
    .collaboration-item {
      background: rgba(255,255,255,0.1);
      padding: 20px;
      border-radius: 12px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.2);
      transition: transform 0.3s ease, background 0.3s ease;
    }
    .collaboration-item:hover {
      transform: translateY(-5px);
      background: rgba(255,255,255,0.15);
    }

    /* Scroll animations */
    .reveal {
      opacity: 0;
      transform: translateY(30px);
      transition: opacity 0.6s ease, transform 0.6s ease;
    }
    .reveal.active {
      opacity: 1;
      transform: translateY(0);
    }

    @media (max-width: 768px) {
      .space-card {
        grid-template-columns: 1fr;
        gap: 30px;
      }
      .space-card.reverse {
        direction: ltr;
      }
      .activities-grid {
        grid-template-columns: 1fr;
      }
      .collaboration-grid {
        grid-template-columns: 1fr;
      }
      .retreat-section {
        padding: 50px 0;
      }
      .retreat-section:first-of-type {
        padding-bottom: 30px;
      }
      .retreat-section.alt {
        padding-top: 30px;
      }
    }
    
    /* Gallery Modal Styles */
    .gallery-modal {
      display: none;
      position: fixed;
      z-index: 10000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.95);
      backdrop-filter: blur(10px);
    }
    .gallery-modal.active {
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .gallery-modal-content {
      position: relative;
      max-width: 90%;
      max-height: 90%;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .gallery-modal-image {
      max-width: 100%;
      max-height: 90vh;
      object-fit: contain;
      border-radius: 8px;
    }
    .gallery-modal-close {
      position: absolute;
      top: 20px;
      right: 30px;
      color: white;
      font-size: 40px;
      font-weight: bold;
      cursor: pointer;
      z-index: 10001;
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(0, 0, 0, 0.5);
      border-radius: 50%;
      transition: background 0.3s ease;
    }
    .gallery-modal-close:hover {
      background: rgba(0, 0, 0, 0.8);
    }
    .gallery-modal-nav {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      color: white;
      font-size: 30px;
      font-weight: bold;
      cursor: pointer;
      z-index: 10001;
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(0, 0, 0, 0.5);
      border-radius: 50%;
      transition: background 0.3s ease;
      user-select: none;
    }
    .gallery-modal-nav:hover {
      background: rgba(0, 0, 0, 0.8);
    }
    .gallery-modal-prev {
      left: 20px;
    }
    .gallery-modal-next {
      right: 20px;
    }
    .gallery-modal-counter {
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      color: white;
      background: rgba(0, 0, 0, 0.5);
      padding: 10px 20px;
      border-radius: 20px;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <a class="logo" href="index.html">
        <img alt="Back to Base" class="logo-img" />
        <span class="logo-text">Back to Base</span>
      </a>
      <nav class="nav">
        <a href="index.html#rooms">Rooms</a>
        <a href="massage.html">Massage</a>
        <a href="retreat-and-workshop.html">Retreats and Workshops</a>
        <a href="special.html">Special</a>
        <a href="about.html">About us</a>
      </nav>
      <button class="mobile-menu-toggle" id="mobile-menu-toggle" aria-label="Toggle mobile menu">
        ☰
      </button>
      <div class="header-actions">
        <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
          <svg class="theme-toggle-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 3v1m0 16v1m9-9h1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <span id="theme-text">Light</span>
        </button>
        <a href="login.html" class="btn-signin" id="header-signin">Sign In</a>
      </div>
    </div>
  </header>

  <!-- Mobile Navigation Overlay -->
  <div class="mobile-nav-overlay" id="mobile-nav-overlay"></div>
  
  <!-- Mobile Navigation Menu -->
  <nav class="mobile-nav" id="mobile-nav">
    <a href="index.html#rooms">Rooms</a>
    <a href="massage.html">Massage</a>
    <a href="retreat-and-workshop.html">Retreats and Workshops</a>
    <a href="special.html">Special</a>
    <a href="about.html">About us</a>
    <a href="login.html" class="mobile-nav-signin" id="mobile-nav-signin">Sign In</a>
    <button class="theme-toggle" id="mobile-theme-toggle" aria-label="Toggle theme">
      <svg class="theme-toggle-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M12 3v1m0 16v1m9-9h1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <span id="mobile-theme-text">Light</span>
    </button>
  </nav>

  <div class="retreat-hero">
    <div class="container">
      <div class="retreat-hero-content reveal">
        <h1 class="retreat-hero-title">Activities and Practices at Back to Base</h1>
        <p class="retreat-hero-subtitle">Where nature and quiet become part of your practice</p>
      </div>
    </div>
  </div>

  <main>
    <!-- Introduction Section -->
    <section class="retreat-section">
      <div class="container">
        <div class="intro-section reveal">
          <p class="retreat-intro-text">Back to Base is a place where nature and quiet become part of your practice. Everything here is designed so that any activity — from yoga to a small creative workshop — takes place in an atmosphere of calm, depth, and inspiration.</p>
        </div>
      </div>
    </section>

    <!-- Spaces Created for Presence Section -->
    <section class="retreat-section alt" style="padding-bottom: 20px;">
      <div class="container">
        <h2 class="reveal retreat-locations-title">Our locations for your workshops</h2>

        <!-- Forest Platforms -->
        <div class="space-card reveal">
          <div class="space-image-wrapper" onclick="window.openGallery('forest', 0)">
            <img src="assets/plarform_1.png" 
                 alt="Forest platforms by the creek" 
                 class="space-image">
            <div class="space-image-overlay">
              <div class="space-image-overlay-icon">
                <img src="assets/ruka.png" alt="Click to view gallery" style="width: 100%; height: 100%; object-fit: contain;">
              </div>
            </div>
          </div>
          <div class="space-content">
            <h3 class="retreat-forest-title">Forest platforms by the creek</h3>
            <p class="retreat-forest-description">Just a few steps from the house, a winding path leads into the forest, where wooden platforms are hidden among tall trees. The air feels lighter here, the sound of the creek creates a natural meditation, and the soft light filtering through the canopy makes every practice deeper.</p>
            <p class="retreat-forest-label">It's an ideal spot for:</p>
            <ul class="retreat-forest-list">
              <li>Sunrise yoga</li>
              <li>Evening meditations</li>
              <li>Breathwork</li>
              <li>Any activity that benefits from a strong connection to nature</li>
            </ul>
          </div>
        </div>

        <!-- Indoor Space -->
        <div class="space-card reverse reveal">
          <div class="space-image-wrapper" onclick="window.openGallery('indoor', 0)">
            <img src="https://images.unsplash.com/photo-1506126613408-eca07ce68773?q=80&w=1200&auto=format&fit=crop" 
                 alt="Warm, bright indoor space" 
                 class="space-image">
            <div class="space-image-overlay">
              <div class="space-image-overlay-icon">
                <img src="assets/ruka.png" alt="Click to view gallery" style="width: 100%; height: 100%; object-fit: contain;">
              </div>
            </div>
          </div>
          <div class="space-content">
            <h3 class="retreat-indoor-title">Warm, bright indoor space at Back to Base</h3>
            <p class="retreat-indoor-description">Inside the house, there is a spacious room with large windows filled with light, warmth, and a sense of comfort — perfect for group gatherings, mini-lectures, workshops, breathwork sessions, or yoga during cooler weather.</p>
            <p class="retreat-indoor-additional">And if you need a more intimate atmosphere or plan to use visual materials, the room can easily be darkened with blackout curtains.</p>
          </div>
        </div>

        <!-- Home Theatre -->
        <div class="space-card reveal">
          <div class="space-image-wrapper" onclick="window.openGallery('theatre', 0)">
            <img src="https://images.unsplash.com/photo-1533750516457-a7f992034fec?q=80&w=1200&auto=format&fit=crop" 
                 alt="Cozy mini home theatre" 
                 class="space-image">
            <div class="space-image-overlay">
              <div class="space-image-overlay-icon">
                <img src="assets/ruka.png" alt="Click to view gallery" style="width: 100%; height: 100%; object-fit: contain;">
              </div>
            </div>
          </div>
          <div class="space-content">
            <h3 class="retreat-theatre-title">Cozy mini home theatre</h3>
            <p class="retreat-theatre-description">For presentations, educational films, documentaries, or shared viewing sessions, we offer a small but very cozy home theatre. Soft lighting, quality sound, and a calm environment help create a fully immersive experience.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Contact Form Section -->
    <section class="retreat-section" style="padding-top: 60px; padding-bottom: 40px;">
      <div class="container">
        <div class="space-card reveal">
          <div class="space-content">
            <h2 class="retreat-contact-title" style="font-size: 2rem; margin-bottom: 20px;">Are you looking for a place to retreat or interested in joining a workshop?</h2>
            <p class="retreat-contact-text" style="font-size: 1.2rem; line-height: 1.8;">
              Just send us a message with your preferences, and we will create a program tailored specifically for you!
            </p>
          </div>
          <div class="contact-form-wrapper" style="background: var(--card); padding: 30px; border-radius: 16px; border: 1px solid var(--border);">
            <form id="contact-form" class="contact-form">
              <div class="form-group">
                <label for="contact-message">Message</label>
                <textarea id="contact-message" name="message" rows="4" 
                          placeholder="Your message..." 
                          class="form-input" required></textarea>
                <span class="field-error" id="message-error"></span>
              </div>
              <div class="form-group">
                <label for="contact-email">Email</label>
                <input type="email" id="contact-email" name="email" required 
                       placeholder="your.email@example.com" 
                       class="form-input">
                <span class="field-error" id="email-error"></span>
              </div>
              <div class="form-group">
                <label for="contact-phone">Phone</label>
                <input type="tel" id="contact-phone" name="phone" required 
                       placeholder="+1 (555) 123-4567" 
                       class="form-input">
                <span class="field-error" id="phone-error"></span>
              </div>
              <div class="form-group">
                <label for="contact-captcha"><span id="captcha-question">What is 8 + 10?</span></label>
                <input type="number" id="contact-captcha" name="captcha" required 
                       placeholder="Enter the answer" 
                       class="form-input">
                <input type="hidden" id="captcha-answer" name="captcha_answer" value="18">
                <span class="field-error" id="captcha-error"></span>
              </div>
              <button type="submit" class="btn primary contact-submit-btn">
                Send Message
              </button>
              <div id="contact-form-message" class="form-message"></div>
            </form>
          </div>
        </div>
      </div>
    </section>

    <!-- Organizer Learn More Section -->
    <section class="retreat-section" style="padding-top: 20px; padding-bottom: 20px;">
      <div class="container">
        <div class="organizer-learn-more reveal">
          <h3 class="retreat-organizer-title">Are you a yoga instructor or an event organizer looking for a place to host your sessions?</h3>
          <button class="learn-more-btn" onclick="toggleWorkshopsSection(this)">
            Learn More
          </button>
        </div>
      </div>
    </section>

    <!-- What workshops are our spaces suitable for? Section -->
    <section id="workshops-section" class="retreat-section" style="padding-top: 0; padding-bottom: 80px; display: none;">
      <div class="container">
        <h2 class="reveal retreat-workshops-title" style="margin-bottom: 15px;">What workshops are our spaces suitable for?</h2>
        
        <p class="reveal retreat-workshops-intro" style="font-size: 1.1rem; line-height: 1.8; color: var(--text-muted); margin-bottom: 1.65rem;">
          The indoor spaces, forest platforms, and the forest itself are ideal for the following practices:
        </p>
        
        <ul class="workshops-list reveal retreat-workshops-list" style="margin-top: 0; margin-bottom: 1.65rem;">
          <li>Group and private yoga sessions</li>
          <li>Meditations and mindfulness practices</li>
          <li>Sound healing and breathwork</li>
          <li>Creative and educational workshops</li>
          <li>Mini-lectures and intimate gatherings</li>
        </ul>
        
        <p class="reveal retreat-workshops-conclusion" style="font-size: 1.1rem; margin-top: 0; line-height: 1.8;">
          Create memorable retreat experiences for your community. Nature here is not just a backdrop — it becomes a full participant. People open up more easily, rest more deeply, and return to themselves more naturally.
        </p>

        <h2 class="reveal retreat-collaboration-title" style="font-size: 2rem; margin-top: 60px; margin-bottom: 15px;">Invitation to Collaborate</h2>
        <p class="reveal retreat-collaboration-intro" style="font-size: 1.1rem; line-height: 1.8; color: var(--text-muted); margin-bottom: 1.65rem;">Back to Base welcomes those who create transformative practices and help people heal and restore.<br>We are looking for:</p>
        
        <ul class="workshops-list reveal retreat-collaboration-list" style="margin-top: 0; margin-bottom: 1.65rem;">
          <li>Program creators</li>
          <li>Yoga instructors</li>
          <li>Meditation teachers</li>
          <li>Massage therapists</li>
          <li>Reiki practitioners</li>
          <li>Acupuncturists</li>
          <li>Body-oriented specialists</li>
        </ul>

        <p class="reveal retreat-collaboration-conclusion" style="font-size: 1.1rem; margin-top: 0; line-height: 1.8;">
          If you want to share your work in the quiet of the forest beside a mountain lake, we would be happy to collaborate with you.<br>Just call or message us!
        </p>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container footer-grid">
      <div>
        <h4>Contact</h4>
        <p id="footer-contact-address">British Columbia, Canada</p>
        <p id="footer-contact-phone">Phone: +1 (555) 123‑4567</p>
        <p id="footer-contact-email">Email: hello@backtobase.example</p>
      </div>
      <div>
        <h4>Navigation</h4>
        <ul class="footer-nav">
          <li><a href="index.html#rooms">Rooms</a></li>
          <li><a href="massage.html">Massage</a></li>
          <li><a href="retreat-and-workshop.html">Retreats and Workshops</a></li>
          <li><a href="special.html">Special</a></li>
          <li><a href="about.html">About us</a></li>
        </ul>
      </div>
      <div>
        <h4>Quiet hours</h4>
        <p>22:00 — 07:00</p>
      </div>
    </div>
    <div class="container copyright">© <span id="year"></span> Back to Base</div>
  </footer>

  <!-- Gallery Modal -->
  <div id="gallery-modal" class="gallery-modal">
    <span class="gallery-modal-close" onclick="window.closeGallery()">&times;</span>
    <span class="gallery-modal-nav gallery-modal-prev" onclick="window.changeGalleryImage(-1)">&#10094;</span>
    <span class="gallery-modal-nav gallery-modal-next" onclick="window.changeGalleryImage(1)">&#10095;</span>
    <div class="gallery-modal-content">
      <img id="gallery-modal-image" class="gallery-modal-image" src="" alt="">
    </div>
    <div class="gallery-modal-counter">
      <span id="gallery-counter">1 / 1</span>
    </div>
  </div>

  <script src="script.js?v=26"></script>
  <script src="auth.js?v=26"></script>
  <script>
    // Load retreat images from admin
    (function() {
      function updateRetreatImages() {
        try {
          const contentData = localStorage.getItem('btb_content');
          if (contentData) {
            const data = JSON.parse(contentData);
            
            // Update hero background
            if (data.retreatHeroImageUrl) {
              const heroSection = document.querySelector('.retreat-hero');
              if (heroSection) {
                heroSection.style.backgroundImage = `url('${data.retreatHeroImageUrl}?v=${Date.now()}')`;
              }
            }
            
            // Update forest platforms image
            if (data.retreatForestImageUrl) {
              const forestCard = document.querySelectorAll('.space-card')[0];
              if (forestCard) {
                const img = forestCard.querySelector('.space-image');
                if (img) {
                  img.src = data.retreatForestImageUrl + '?v=' + Date.now();
                }
              }
            }
            
            // Update indoor space image
            if (data.retreatIndoorImageUrl) {
              const indoorCard = document.querySelectorAll('.space-card')[1];
              if (indoorCard) {
                const img = indoorCard.querySelector('.space-image');
                if (img) {
                  img.src = data.retreatIndoorImageUrl + '?v=' + Date.now();
                }
              }
            }
            
            // Update home theatre image
            if (data.retreatTheatreImageUrl) {
              const theatreCard = document.querySelectorAll('.space-card')[2];
              if (theatreCard) {
                const img = theatreCard.querySelector('.space-image');
                if (img) {
                  img.src = data.retreatTheatreImageUrl + '?v=' + Date.now();
                }
              }
            }
          }
        } catch(e) {
          console.error('Error updating retreat images:', e);
        }
      }
      
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', updateRetreatImages);
      } else {
        updateRetreatImages();
      }
      
      // Also try to load from API
      async function loadRetreatImagesFromAPI() {
        try {
          const formData = new FormData();
          formData.append('action', 'get_content');
          
          const response = await fetch('api.php', {
            method: 'POST',
            body: formData
          });
          
          if (response.ok) {
            const result = await response.json();
            if (result.success && result.data) {
              const contentData = {
                retreatHeroImageUrl: result.data.retreatHeroImageUrl || '',
                retreatForestImageUrl: result.data.retreatForestImageUrl || '',
                retreatIndoorImageUrl: result.data.retreatIndoorImageUrl || '',
                retreatTheatreImageUrl: result.data.retreatTheatreImageUrl || ''
              };
              
              const existing = localStorage.getItem('btb_content');
              let existingData = {};
              if (existing) {
                try {
                  existingData = JSON.parse(existing);
                } catch(e) {
                  console.error('Failed to parse existing localStorage:', e);
                }
              }
              
              const mergedData = { ...existingData, ...contentData };
              localStorage.setItem('btb_content', JSON.stringify(mergedData));
              
              updateRetreatImages();
            }
          }
        } catch (error) {
          console.log('Failed to load retreat images from API:', error);
        }
      }
      
      setTimeout(loadRetreatImagesFromAPI, 100);
    })();
    
    // Gallery data for space images - will be updated with admin images
    let galleries = {
      forest: [
        'assets/plarform_1.png',
        'assets/plarform_2.png',
        'https://images.unsplash.com/photo-1533750516457-a7f992034fec?q=80&w=1200&auto=format&fit=crop',
        'https://images.unsplash.com/photo-1441974231531-c6227db76b6e?q=80&w=1200&auto=format&fit=crop',
        'https://images.unsplash.com/photo-1511497584788-876760111969?q=80&w=1200&auto=format&fit=crop',
        'https://images.unsplash.com/photo-1519904981063-e0dca86916b1?q=80&w=1200&auto=format&fit=crop',
        'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?q=80&w=1200&auto=format&fit=crop',
        'https://images.unsplash.com/photo-1447752875215-b2761acb3c5d?q=80&w=1200&auto=format&fit=crop'
      ],
      indoor: [
        'https://images.unsplash.com/photo-1506126613408-eca07ce68773?q=80&w=1200&auto=format&fit=crop',
        'https://images.unsplash.com/photo-1522771739844-6a9f6d5f14af?q=80&w=1200&auto=format&fit=crop',
        'https://images.unsplash.com/photo-1493663284031-6c6c18a7c93a?q=80&w=1200&auto=format&fit=crop',
        'https://images.unsplash.com/photo-1502672260266-1c1ef2d93688?q=80&w=1200&auto=format&fit=crop',
        'https://images.unsplash.com/photo-1522771739844-6a9f6d5f14af?q=80&w=1200&auto=format&fit=crop',
        'https://images.unsplash.com/photo-1493809842364-78817add7ffb?q=80&w=1200&auto=format&fit=crop',
        'https://images.unsplash.com/photo-1484154218962-a197022b5858?q=80&w=1200&auto=format&fit=crop',
        'https://images.unsplash.com/photo-1505843513577-22bb7d21e455?q=80&w=1200&auto=format&fit=crop'
      ],
      theatre: [
        'https://images.unsplash.com/photo-1533750516457-a7f992034fec?q=80&w=1200&auto=format&fit=crop',
        'https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?q=80&w=1200&auto=format&fit=crop',
        'https://images.unsplash.com/photo-1485846234645-a62644f84728?q=80&w=1200&auto=format&fit=crop',
        'https://images.unsplash.com/photo-1517604931442-7e0c8ed2963c?q=80&w=1200&auto=format&fit=crop',
        'https://images.unsplash.com/photo-1489599849927-2ee91cede3ba?q=80&w=1200&auto=format&fit=crop',
        'https://images.unsplash.com/photo-1512070679279-8988d32161be?q=80&w=1200&auto=format&fit=crop',
        'https://images.unsplash.com/photo-1489599849927-2ee91cede3ba?q=80&w=1200&auto=format&fit=crop',
        'https://images.unsplash.com/photo-1517604931442-7e0c8ed2963c?q=80&w=1200&auto=format&fit=crop'
      ]
    };
    
    // Update galleries with admin images
    try {
      const contentData = localStorage.getItem('btb_content');
      if (contentData) {
        const data = JSON.parse(contentData);
        if (data.retreatForestImageUrl && galleries.forest.length > 0) {
          galleries.forest[0] = data.retreatForestImageUrl;
        }
        if (data.retreatIndoorImageUrl && galleries.indoor.length > 0) {
          galleries.indoor[0] = data.retreatIndoorImageUrl;
        }
        if (data.retreatTheatreImageUrl && galleries.theatre.length > 0) {
          galleries.theatre[0] = data.retreatTheatreImageUrl;
        }
      }
    } catch(e) {
      console.error('Error updating galleries:', e);
    }

    let currentGallery = null;
    let currentImageIndex = 0;

    // Gallery functions - make them globally available
    window.openGallery = function(galleryName, imageIndex) {
      currentGallery = galleryName;
      currentImageIndex = imageIndex || 0;
      const gallery = galleries[galleryName];
      
      if (!gallery || gallery.length === 0) return;
      
      const modal = document.getElementById('gallery-modal');
      const modalImage = document.getElementById('gallery-modal-image');
      const counter = document.getElementById('gallery-counter');
      
      modalImage.src = gallery[currentImageIndex];
      counter.textContent = `${currentImageIndex + 1} / ${gallery.length}`;
      modal.classList.add('active');
      
      // Prevent body scroll
      document.body.style.overflow = 'hidden';
    }

    window.closeGallery = function() {
      const modal = document.getElementById('gallery-modal');
      modal.classList.remove('active');
      document.body.style.overflow = '';
    }

    window.changeGalleryImage = function(direction) {
      if (!currentGallery) return;
      
      const gallery = galleries[currentGallery];
      if (!gallery || gallery.length === 0) return;
      
      currentImageIndex += direction;
      
      if (currentImageIndex < 0) {
        currentImageIndex = gallery.length - 1;
      } else if (currentImageIndex >= gallery.length) {
        currentImageIndex = 0;
      }
      
      const modalImage = document.getElementById('gallery-modal-image');
      const counter = document.getElementById('gallery-counter');
      
      modalImage.src = gallery[currentImageIndex];
      counter.textContent = `${currentImageIndex + 1} / ${gallery.length}`;
    }

    // Close gallery on Escape key
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        window.closeGallery();
      } else if (e.key === 'ArrowLeft') {
        window.changeGalleryImage(-1);
      } else if (e.key === 'ArrowRight') {
        window.changeGalleryImage(1);
      }
    });

    // Close gallery when clicking outside image
    document.getElementById('gallery-modal').addEventListener('click', function(e) {
      if (e.target === this || e.target.classList.contains('gallery-modal-content')) {
        window.closeGallery();
      }
    });

    // Toggle workshops section
    function toggleWorkshopsSection(button) {
      const section = document.getElementById('workshops-section');
      const isVisible = section.style.display !== 'none';
      
      if (isVisible) {
        section.style.display = 'none';
        button.classList.remove('active');
        button.textContent = 'Learn More';
      } else {
        section.style.display = 'block';
        button.classList.add('active');
        button.textContent = 'Show Less';
        // Scroll to section
        setTimeout(() => {
          section.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }, 100);
      }
    }
    window.toggleWorkshopsSection = toggleWorkshopsSection;

    // Contact form handling
    document.getElementById('contact-form').addEventListener('submit', async function(e) {
      e.preventDefault();
      
      const form = this;
      const formData = new FormData(form);
      const messageDiv = document.getElementById('contact-form-message');
      const submitBtn = form.querySelector('.contact-submit-btn');
      
      // Clear previous errors
      document.querySelectorAll('.field-error').forEach(el => el.classList.remove('show'));
      messageDiv.className = 'form-message';
      
      // Validate captcha
      const captchaAnswer = parseInt(document.getElementById('captcha-answer').value);
      const captchaInput = parseInt(document.getElementById('contact-captcha').value);
      
      if (captchaInput !== captchaAnswer) {
        document.getElementById('captcha-error').textContent = 'Incorrect answer';
        document.getElementById('captcha-error').classList.add('show');
        return;
      }
      
      submitBtn.disabled = true;
      submitBtn.textContent = 'Sending...';
      
      try {
        const response = await fetch('email_service.php', {
          method: 'POST',
          body: formData
        });
        
        const result = await response.json();
        
        if (result.success) {
          messageDiv.className = 'form-message success';
          messageDiv.textContent = 'Message sent successfully! We will get back to you soon.';
          form.reset();
        } else {
          messageDiv.className = 'form-message error';
          messageDiv.textContent = result.message || 'Error sending message. Please try again.';
        }
      } catch (error) {
        messageDiv.className = 'form-message error';
        messageDiv.textContent = 'Error sending message. Please try again.';
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = 'Send Message';
      }
    });

    // Scroll reveal animation
    const observerOptions = {
      threshold: 0.1,
      rootMargin: '0px 0px -50px 0px'
    };

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('active');
        }
      });
    }, observerOptions);

    document.querySelectorAll('.reveal').forEach(el => {
      observer.observe(el);
    });

    // Trigger initial reveal for hero
    window.addEventListener('load', () => {
      const hero = document.querySelector('.retreat-hero .reveal');
      if (hero) {
        setTimeout(() => hero.classList.add('active'), 100);
      }
    });

    // Load and update retreat content from localStorage or API
    (function() {
      'use strict';
      
      // Try to load from localStorage first (fastest)
      const storedContent = localStorage.getItem('btb_retreat_workshop_content');
      if (storedContent) {
        try {
          const content = JSON.parse(storedContent);
          updateRetreatPageContent(content);
        } catch (e) {
          console.error('Failed to parse stored retreat content:', e);
        }
      }
      
      // Also fetch from API to ensure we have the latest data
      fetch('api.php', {
        method: 'POST',
        body: (() => {
          const formData = new FormData();
          formData.append('action', 'get_content');
          return formData;
        })()
      })
      .then(response => response.json())
      .then(result => {
        if (result.success && result.data) {
          const data = result.data;
          const content = {
            retreatHeroTitle: data.retreatHeroTitle || '',
            retreatHeroSubtitle: data.retreatHeroSubtitle || '',
            retreatIntroText: data.retreatIntroText || '',
            retreatLocationsTitle: data.retreatLocationsTitle || '',
            retreatForestTitle: data.retreatForestTitle || '',
            retreatForestDescription: data.retreatForestDescription || '',
            retreatForestListLabel: data.retreatForestListLabel || '',
            retreatForestListItems: data.retreatForestListItems || '',
            retreatIndoorTitle: data.retreatIndoorTitle || '',
            retreatIndoorDescription: data.retreatIndoorDescription || '',
            retreatIndoorAdditional: data.retreatIndoorAdditional || '',
            retreatTheatreTitle: data.retreatTheatreTitle || '',
            retreatTheatreDescription: data.retreatTheatreDescription || '',
            retreatContactTitle: data.retreatContactTitle || '',
            retreatContactText: data.retreatContactText || '',
            retreatOrganizerTitle: data.retreatOrganizerTitle || '',
            retreatWorkshopsTitle: data.retreatWorkshopsTitle || '',
            retreatWorkshopsIntro: data.retreatWorkshopsIntro || '',
            retreatWorkshopsList: data.retreatWorkshopsList || '',
            retreatWorkshopsConclusion: data.retreatWorkshopsConclusion || '',
            retreatCollaborationTitle: data.retreatCollaborationTitle || '',
            retreatCollaborationIntro: data.retreatCollaborationIntro || '',
            retreatCollaborationList: data.retreatCollaborationList || '',
            retreatCollaborationConclusion: data.retreatCollaborationConclusion || ''
          };
          
          // Save to localStorage for future loads
          localStorage.setItem('btb_retreat_workshop_content', JSON.stringify(content));
          
          // Update page
          updateRetreatPageContent(content);
        }
      })
      .catch(error => {
        console.error('Failed to load retreat content from API:', error);
      });
      
      function updateRetreatPageContent(content) {
        // Hero section
        const heroTitle = document.querySelector('.retreat-hero-title');
        const heroSubtitle = document.querySelector('.retreat-hero-subtitle');
        if (heroTitle && content.retreatHeroTitle) heroTitle.textContent = content.retreatHeroTitle;
        if (heroSubtitle && content.retreatHeroSubtitle) heroSubtitle.textContent = content.retreatHeroSubtitle;
        
        // Introduction
        const introText = document.querySelector('.retreat-intro-text');
        if (introText && content.retreatIntroText) introText.textContent = content.retreatIntroText;
        
        // Locations title
        const locationsTitle = document.querySelector('.retreat-locations-title');
        if (locationsTitle && content.retreatLocationsTitle) locationsTitle.textContent = content.retreatLocationsTitle;
        
        // Forest Platforms
        const forestTitle = document.querySelector('.retreat-forest-title');
        const forestDesc = document.querySelector('.retreat-forest-description');
        const forestLabel = document.querySelector('.retreat-forest-label');
        const forestList = document.querySelector('.retreat-forest-list');
        if (forestTitle && content.retreatForestTitle) forestTitle.textContent = content.retreatForestTitle;
        if (forestDesc && content.retreatForestDescription) forestDesc.textContent = content.retreatForestDescription;
        if (forestLabel && content.retreatForestListLabel) forestLabel.textContent = content.retreatForestListLabel;
        if (forestList && content.retreatForestListItems) {
          const items = content.retreatForestListItems.split('\n').filter(item => item.trim());
          forestList.innerHTML = items.map(item => `<li>${item.trim()}</li>`).join('');
        } else if (forestList && !content.retreatForestListItems) {
          // Keep default if no content
        }
        
        // Indoor Space
        const indoorTitle = document.querySelector('.retreat-indoor-title');
        const indoorDesc = document.querySelector('.retreat-indoor-description');
        const indoorAdd = document.querySelector('.retreat-indoor-additional');
        if (indoorTitle && content.retreatIndoorTitle) indoorTitle.textContent = content.retreatIndoorTitle;
        if (indoorDesc && content.retreatIndoorDescription) indoorDesc.textContent = content.retreatIndoorDescription;
        if (indoorAdd && content.retreatIndoorAdditional) indoorAdd.textContent = content.retreatIndoorAdditional;
        
        // Home Theatre
        const theatreTitle = document.querySelector('.retreat-theatre-title');
        const theatreDesc = document.querySelector('.retreat-theatre-description');
        if (theatreTitle && content.retreatTheatreTitle) theatreTitle.textContent = content.retreatTheatreTitle;
        if (theatreDesc && content.retreatTheatreDescription) theatreDesc.textContent = content.retreatTheatreDescription;
        
        // Contact Form
        const contactTitle = document.querySelector('.retreat-contact-title');
        const contactText = document.querySelector('.retreat-contact-text');
        if (contactTitle && content.retreatContactTitle) contactTitle.textContent = content.retreatContactTitle;
        if (contactText && content.retreatContactText) contactText.textContent = content.retreatContactText;
        
        // Organizer
        const organizerTitle = document.querySelector('.retreat-organizer-title');
        if (organizerTitle && content.retreatOrganizerTitle) organizerTitle.textContent = content.retreatOrganizerTitle;
        
        // Workshops
        const workshopsTitle = document.querySelector('.retreat-workshops-title');
        const workshopsIntro = document.querySelector('.retreat-workshops-intro');
        const workshopsList = document.querySelector('.retreat-workshops-list');
        const workshopsConclusion = document.querySelector('.retreat-workshops-conclusion');
        if (workshopsTitle && content.retreatWorkshopsTitle) workshopsTitle.textContent = content.retreatWorkshopsTitle;
        if (workshopsIntro && content.retreatWorkshopsIntro) workshopsIntro.textContent = content.retreatWorkshopsIntro;
        if (workshopsList && content.retreatWorkshopsList) {
          const items = content.retreatWorkshopsList.split('\n').filter(item => item.trim());
          workshopsList.innerHTML = items.map(item => `<li>${item.trim()}</li>`).join('');
        } else if (workshopsList && !content.retreatWorkshopsList) {
          // Keep default if no content
        }
        if (workshopsConclusion && content.retreatWorkshopsConclusion) workshopsConclusion.textContent = content.retreatWorkshopsConclusion;
        
        // Collaboration
        const collaborationTitle = document.querySelector('.retreat-collaboration-title');
        const collaborationIntro = document.querySelector('.retreat-collaboration-intro');
        const collaborationList = document.querySelector('.retreat-collaboration-list');
        const collaborationConclusion = document.querySelector('.retreat-collaboration-conclusion');
        if (collaborationTitle && content.retreatCollaborationTitle) collaborationTitle.textContent = content.retreatCollaborationTitle;
        if (collaborationIntro && content.retreatCollaborationIntro) collaborationIntro.textContent = content.retreatCollaborationIntro;
        if (collaborationList && content.retreatCollaborationList) {
          const items = content.retreatCollaborationList.split('\n').filter(item => item.trim());
          collaborationList.innerHTML = items.map(item => `<li>${item.trim()}</li>`).join('');
        } else if (collaborationList && !content.retreatCollaborationList) {
          // Keep default if no content
        }
        if (collaborationConclusion && content.retreatCollaborationConclusion) collaborationConclusion.textContent = content.retreatCollaborationConclusion;
      }
    })();
  </script>
</body>
</html>
