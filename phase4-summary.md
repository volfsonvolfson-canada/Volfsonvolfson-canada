# Phase 4: Airbnb –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è - –†–µ–∑—é–º–µ

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. iCal –ü–∞—Ä—Å–µ—Ä (`ical_parser.php`)
- –ü–∞—Ä—Å–∏–Ω–≥ iCal –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–π –æ—Ç Airbnb
- –ó–∞–≥—Ä—É–∑–∫–∞ iCal –¥–∞–Ω–Ω—ã—Ö –ø–æ URL
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∑–∞–Ω—è—Ç—ã—Ö –¥–∞—Ç –∏–∑ —Å–æ–±—ã—Ç–∏–π (VEVENT)
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ –¥–∞—Ç
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –¥–∞—Ç

### 2. –°–µ—Ä–≤–∏—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ Airbnb (`airbnb_sync.php`)
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–π –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–Ω–∞—Ç –∏–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫–æ–º–Ω–∞—Ç—ã
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–Ω—è—Ç—ã—Ö –¥–∞—Ç –≤ —Ç–∞–±–ª–∏—Ü—É `airbnb_calendar`
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –¥–∞—Ç —Å —É—á–µ—Ç–æ–º Airbnb —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–Ω—è—Ç—ã—Ö –¥–∞—Ç –∏–∑ Airbnb –¥–ª—è –∫–æ–º–Ω–∞—Ç—ã
- –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

### 3. API Endpoints (`booking_api.php`)
- `sync_airbnb` - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è Airbnb (—Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞)
- `get_airbnb_sync_status` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- `get_blocked_dates` - –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –∏ —Ä—É—á–Ω—ã—Ö –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫, –∏ Airbnb –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫

### 4. Cron –°–∫—Ä–∏–ø—Ç (`cron_sync_airbnb.php`)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∑–∞–ø—É—Å–∫–∞ –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ (cron)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∑–∞–ø—É—Å–∫–∞ —á–µ—Ä–µ–∑ –≤–µ–±-–∑–∞–ø—Ä–æ—Å (—Å —Ç–æ–∫–µ–Ω–æ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

### 5. –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (`admin.html`, `admin.js`)
- –ö–Ω–æ–ø–∫–∞ "Sync with Airbnb" –≤ —Ä–∞–∑–¥–µ–ª–µ Calendar
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- –ö–∞–ª–µ–Ω–¥–∞—Ä—å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç Airbnb –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞—Ç—ã

### 6. –í–∏–¥–∂–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ (`availability-calendar.js`)
- –û–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è —É—á–µ—Ç–∞ Airbnb –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞—Ç
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞—Ç—ã (—Ä—É—á–Ω—ã–µ + Airbnb)

## üîß –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º–æ–π

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
–§—É–Ω–∫—Ü–∏—è `checkDateAvailability()` –≤ `booking_api.php` —É–∂–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:
1. ‚úÖ –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
2. ‚úÖ –†—É—á–Ω—ã–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (—Ç–∞–±–ª–∏—Ü–∞ `blocked_dates`)
3. ‚úÖ **Airbnb —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é (—Ç–∞–±–ª–∏—Ü–∞ `airbnb_calendar`)** ‚Üê –¥–æ–±–∞–≤–ª–µ–Ω–æ

### API Endpoints
–í—Å–µ –Ω–æ–≤—ã–µ endpoints –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ `booking_api.php`:
- `sync_airbnb` - –¥–ª—è —Ä—É—á–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∏–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
- `get_airbnb_sync_status` - –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞

## üìã –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ –≤ `config.php`:
```php
$AIRBNB_ICAL_URLS = [
    'Basement ‚Äî Queen' => '', // ‚ö†Ô∏è –ë—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –ø–æ–∑–∂–µ
    'Ground floor ‚Äî Queen bed' => '', // ‚ö†Ô∏è –ë—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –ø–æ–∑–∂–µ
    'Ground floor ‚Äî Twin beds' => '', // ‚ö†Ô∏è –ë—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –ø–æ–∑–∂–µ
    'Second floor (entire) ‚Äî Queen bed' => 'https://www.airbnb.ca/calendar/ical/49811499.ics?s=...', // ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ
];
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

1. `airbnb-ical-setup-guide.md` - –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å iCal URL –æ—Ç Airbnb
2. `airbnb-setup-instructions.md` - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –∫–æ–º–Ω–∞—Ç:
1. –ü–æ–ª—É—á–∏—Ç–µ iCal URL –¥–ª—è –Ω–æ–≤–æ–π –∫–æ–º–Ω–∞—Ç—ã –Ω–∞ Airbnb
2. –î–æ–±–∞–≤—å—Ç–µ URL –≤ `config.php` –≤ –º–∞—Å—Å–∏–≤ `$AIRBNB_ICAL_URLS`
3. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π `config.php` –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥
4. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –∏–ª–∏ cron

### –î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:
1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ cron job (—Å–º. `airbnb-setup-instructions.md`)
2. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–∏—Å –¥–ª—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏—Ö –≤–µ–±-–∑–∞–ø—Ä–æ—Å–æ–≤ –∫ `cron_sync_airbnb.php`

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** iCal URL —Å–æ–¥–µ—Ä–∂–∞—Ç –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã Airbnb –∞–∫–∫–∞—É–Ω—Ç–∞ - —Ö—Ä–∞–Ω–∏—Ç–µ –∏—Ö –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
2. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:** –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ö–æ—Ç—è –±—ã —Ä–∞–∑ –≤ –¥–µ–Ω—å
3. **–û—à–∏–±–∫–∏:** –í—Å–µ –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ `logActivity()` –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
4. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –ü–∞—Ä—Å–∏–Ω–≥ –±–æ–ª—å—à–∏—Ö –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–π –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:

1. –í–æ–π–¥–∏—Ç–µ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "Calendar"
3. –ù–∞–∂–º–∏—Ç–µ "Sync with Airbnb"
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞–ª–µ–Ω–¥–∞—Ä—å - –¥–æ–ª–∂–Ω—ã –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∑–∞–Ω—è—Ç—ã–µ –¥–∞—Ç—ã –∏–∑ Airbnb

## üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- ‚úÖ `ical_parser.php` - –ü–∞—Ä—Å–µ—Ä iCal –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–π
- ‚úÖ `airbnb_sync.php` - –°–µ—Ä–≤–∏—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ Airbnb
- ‚úÖ `cron_sync_airbnb.php` - Cron —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- ‚úÖ `airbnb-ical-setup-guide.md` - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –ø–æ–ª—É—á–µ–Ω–∏—é iCal URL
- ‚úÖ `airbnb-setup-instructions.md` - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
- ‚úÖ `phase4-summary.md` - –≠—Ç–æ —Ä–µ–∑—é–º–µ

## üìù –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- ‚úÖ `config.php` - –î–æ–±–∞–≤–ª–µ–Ω –º–∞—Å—Å–∏–≤ `$AIRBNB_ICAL_URLS` —Å iCal URL –¥–ª—è –∫–æ–º–Ω–∞—Ç—ã
- ‚úÖ `booking_api.php` - –î–æ–±–∞–≤–ª–µ–Ω—ã endpoints `sync_airbnb` –∏ `get_airbnb_sync_status`
- ‚úÖ `admin.html` - –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∏ —Å—Ç–∞—Ç—É—Å –≤ —Ä–∞–∑–¥–µ–ª–µ Calendar
- ‚úÖ `admin.js` - –î–æ–±–∞–≤–ª–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ `syncAirbnbCalendar()` –∏ `loadAirbnbSyncStatus()`
- ‚úÖ `availability-calendar.js` - –û–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è —É—á–µ—Ç–∞ Airbnb –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞—Ç

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä—å —Å–∏—Å—Ç–µ–º–∞:
- ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º Airbnb
- ‚úÖ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥–≤–æ–π–Ω—ã–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∑–∞–Ω—è—Ç—ã–µ –¥–∞—Ç—ã –∏–∑ Airbnb –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å —É—á–µ—Ç–æ–º Airbnb —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- ‚úÖ –ü–æ–∑–≤–æ–ª—è–µ—Ç —Ä—É—á–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ cron

–í—Å–µ –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üéâ



