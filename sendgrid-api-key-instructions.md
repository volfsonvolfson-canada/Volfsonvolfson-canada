# Инструкция по получению SendGrid API ключа

## Шаг 1: Регистрация на SendGrid

### 1.1 Откройте сайт SendGrid
1. Перейдите на сайт SendGrid: https://sendgrid.com
2. Нажмите кнопку **"Start for free"** или **"Get Started for Free"** (Начать бесплатно)
3. Или прямо на страницу регистрации: https://signup.sendgrid.com

### 1.2 Заполните форму регистрации
1. Введите ваше **имя** (Name)
2. Введите ваш **email адрес** (Email)
3. Придумайте **пароль** (Password)
   - Минимум 8 символов
   - Должен содержать буквы и цифры
4. Введите **название компании** (Company Name):
   - Например: "Back to Base Hotel" или ваше название
5. Выберите **страну**: Canada
6. Прочитайте и примите **Terms of Service** (Условия использования)
7. Нажмите кнопку **"Create Account"** (Создать аккаунт)

### 1.3 Подтверждение email
1. Проверьте ваш email-ящик
2. Найдите письмо от SendGrid
3. Нажмите на ссылку подтверждения в письме
4. После подтверждения вы попадете в Dashboard SendGrid

## Шаг 2: Вход в Dashboard SendGrid

### 2.1 Первый вход
1. После подтверждения email вас перенаправит на страницу входа
2. Или перейдите на: https://app.sendgrid.com/login
3. Введите ваш email и пароль
4. Нажмите **"Log In"** (Войти)

### 2.2 Первоначальная настройка
При первом входе SendGrid может попросить:
- **Верификацию домена или email** - это важно для отправки писем
- **Выбор плана** - выберите **Free** (бесплатный план)
  - Бесплатный план: 100 писем в день навсегда
  - Этого достаточно для начала

## Шаг 3: Верификация отправителя (Sender Verification)

**Важно**: Для отправки писем нужно верифицировать email адрес или домен.

### Вариант A: Верификация одного email адреса (Проще)

1. В левом меню Dashboard найдите раздел **"Settings"** (Настройки)
2. Нажмите на **"Settings"** чтобы раскрыть подменю
3. Выберите **"Sender Authentication"** (Аутентификация отправителя)
4. Выберите **"Single Sender Verification"** (Верификация одного отправителя)
5. Нажмите **"Create New Sender"** (Создать нового отправителя)
6. Заполните форму:
   - **From Email**: Email адрес, с которого будут отправляться письма (например, `bookings@backtobase.ca`)
   - **From Name**: Имя отправителя (например, "Back to Base Hotel")
   - **Reply To**: Email для ответов (можно тот же или другой)
   - **Company Address**: Адрес компании
   - **City**: Город
   - **State/Province/Region**: Провинция
   - **Country**: Canada
   - **Zip/Postal Code**: Почтовый индекс
7. Нажмите **"Create"** (Создать)
8. Проверьте ваш email - придет письмо с подтверждением
9. Нажмите на ссылку подтверждения в письме

**Важно**: Email должен быть реальным и доступным, так как туда придет письмо подтверждения.

### Вариант B: Верификация домена (Для продакшена)

Если у вас есть собственный домен (например, `backtobase.ca`), лучше верифицировать домен:
1. В **Settings** → **Sender Authentication** выберите **"Domain Authentication"**
2. Следуйте инструкциям по добавлению DNS записей в настройки домена

**Но для начала**: Можно использовать **Single Sender Verification** (вариант A).

## Шаг 4: Получение API ключа

### 4.1 Откройте раздел API Keys
1. В левом боковом меню Dashboard найдите раздел **"Settings"** (Настройки)
2. Нажмите на **"Settings"** чтобы раскрыть подменю
3. Выберите **"API Keys"** (API ключи)

Или используйте прямой URL:
- https://app.sendgrid.com/settings/api_keys

### 4.2 Создайте новый API ключ
1. На странице API Keys вы увидите кнопку **"Create API Key"** (Создать API ключ)
2. Нажмите на эту кнопку
3. Заполните форму создания ключа:
   - **API Key Name** (Название ключа): 
     - Например: "Back to Base Booking System"
     - Или: "Hotel Bookings"
     - Любое понятное название для вас
   - **API Key Permissions** (Права доступа):
     - Выберите **"Full Access"** (Полный доступ) - для начала
     - Или **"Restricted Access"** (Ограниченный доступ) - выберите только:
       - ✅ **Mail Send** (Отправка писем)
       - ✅ **Mail Settings** (Настройки почты)
4. Нажмите кнопку **"Create & View"** (Создать и просмотреть)

### 4.3 Скопируйте API ключ

⚠️ **ОЧЕНЬ ВАЖНО**: API ключ показывается только один раз!

1. После создания ключа появится окно с вашим API ключом
2. Ключ будет выглядеть примерно так: `SG.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx`
3. **НЕМЕДЛЕННО скопируйте ключ**:
   - Выделите весь ключ
   - Нажмите Ctrl+C (Windows) или Cmd+C (Mac)
   - Или нажмите кнопку **"Copy"** рядом с ключом
4. Сохраните ключ в безопасное место:
   - В текстовый файл на вашем компьютере
   - В менеджер паролей
   - **НО НЕ в публичный доступ** (GitHub, публичные файлы и т.д.)

**Важно**: 
- Если вы потеряете ключ, его нельзя будет просмотреть снова
- Придется создать новый ключ
- Старый ключ можно будет удалить

### 4.4 Закройте окно с ключом
1. После копирования нажмите **"Done"** (Готово)
2. Вы попадете на страницу со списком всех API ключей
3. Ваш новый ключ появится в списке, но сам ключ больше не будет виден

## Шаг 5: Добавление API ключа в config.php

### 5.1 Откройте файл config.php
1. Откройте файл `config.php` на вашем компьютере
2. Найдите секцию с настройками SendGrid:
   ```php
   // ==========================================
   // Настройки SendGrid (Email-сервис)
   // ==========================================
   define('SENDGRID_API_KEY', ''); // ⚠️ ЗАМЕНИТЕ на ваш SendGrid API ключ
   define('SENDGRID_FROM_EMAIL', 'bookings@backtobase.ca');
   define('SENDGRID_FROM_NAME', 'Back to Base Hotel');
   define('SENDGRID_HOST_EMAIL', ''); // ⚠️ Email хозяина гостиницы для уведомлений
   ```

### 5.2 Добавьте API ключ
1. Вставьте ваш скопированный API ключ между кавычками:
   ```php
   define('SENDGRID_API_KEY', 'SG.ваш_скопированный_ключ_здесь');
   ```
2. Добавьте email хозяина гостиницы (куда будут приходить уведомления о новых бронированиях):
   ```php
   define('SENDGRID_HOST_EMAIL', 'ваш_email@example.com');
   ```
3. Проверьте, что email отправителя совпадает с верифицированным email:
   ```php
   define('SENDGRID_FROM_EMAIL', 'bookings@backtobase.ca'); // Или ваш верифицированный email
   ```

### 5.3 Сохраните файл
1. Сохраните файл `config.php`
2. Загрузите обновленный файл на хостинг

## Шаг 6: Проверка работы (Опционально)

После добавления ключа можно проверить, что всё работает:

1. В SendGrid Dashboard → **Activity** → **Email Activity**
2. После отправки тестового письма вы должны увидеть запись в Activity
3. Если письмо успешно отправлено - всё работает!

## Бесплатный план SendGrid

**Free Plan** (бесплатный план):
- ✅ **100 писем в день** навсегда
- ✅ **Unlimited contacts** (неограниченные контакты)
- ✅ Базовые шаблоны email
- ✅ API доступ
- ✅ Поддержка по email

**Для начала этого достаточно!** Если понадобится больше писем, можно перейти на платный план позже.

## Безопасность API ключа

⚠️ **ВАЖНЫЕ ПРАВИЛА БЕЗОПАСНОСТИ**:

1. ❌ **НИКОГДА** не публикуйте API ключ в публичных репозиториях (GitHub, GitLab)
2. ❌ **НИКОГДА** не делитесь API ключом с кем-либо
3. ✅ Храните API ключ только в `config.php` на хостинге
4. ✅ `config.php` должен быть защищен от публичного доступа
5. ✅ Используйте API ключ только на бэкенде (PHP)
6. ✅ Если ключ был скомпрометирован - немедленно удалите его в SendGrid и создайте новый

## Управление API ключами

В SendGrid Dashboard → Settings → API Keys вы можете:
- **Просмотреть список** всех созданных ключей
- **Переименовать ключ** (изменить название)
- **Отозвать ключ** (удалить) - если ключ был скомпрометирован
- **Создать новый ключ** - если старый был потерян

## Полезные ссылки

- SendGrid Dashboard: https://app.sendgrid.com
- API Keys: https://app.sendgrid.com/settings/api_keys
- Sender Authentication: https://app.sendgrid.com/settings/sender_auth
- Документация SendGrid: https://docs.sendgrid.com
- SendGrid PHP SDK: https://github.com/sendgrid/sendgrid-php

## Краткая памятка

1. ✅ Зарегистрируйтесь на https://sendgrid.com
2. ✅ Верифицируйте email отправителя (Single Sender Verification)
3. ✅ Перейдите в Settings → API Keys
4. ✅ Создайте новый API ключ (Full Access или Restricted - Mail Send)
5. ✅ Скопируйте ключ (показывается только один раз!)
6. ✅ Добавьте ключ в `config.php` как `SENDGRID_API_KEY`
7. ✅ Добавьте email хозяина как `SENDGRID_HOST_EMAIL`
8. ✅ Сохраните и загрузите на хостинг

## Что делать дальше

После получения и добавления API ключа:
1. ✅ Сообщите мне, что API ключ добавлен
2. ✅ Или продолжайте получать другие ключи (Stripe)
3. ✅ Затем я продолжу реализацию Phase 2 (Email-система)

Если возникнут вопросы или проблемы при регистрации - напишите мне, и я помогу решить проблему!



