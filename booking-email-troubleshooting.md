# üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞: –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ, –Ω–æ –ø–∏—Å—å–º–∞ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è

## ‚úÖ –•–æ—Ä–æ—à–∏–µ –Ω–æ–≤–æ—Å—Ç–∏

**–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ —É—Å–ø–µ—à–Ω–æ:**
- ‚úÖ –ö–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è: `BTB-1762222326-0002`
- ‚úÖ –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `booking-confirmation.html` –ø—Ä–æ–∏–∑–æ—à–µ–ª
- ‚úÖ –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

**–ó–Ω–∞—á–∏—Ç API —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ!**

---

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞

**–ü–∏—Å—å–º–∞ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ Mailgun Dashboard**

**–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:** –§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∏—Å–µ–º –ª–∏–±–æ:
1. –ù–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
2. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è, –Ω–æ –ø–∞–¥–∞–µ—Ç —Å –æ—à–∏–±–∫–æ–π
3. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è, –Ω–æ Mailgun –æ—Ç–∫–ª–æ–Ω—è–µ—Ç –ø–∏—Å—å–º–∞

---

## üîß –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

### 1. –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `booking_api.php`

**–î–æ–±–∞–≤–ª–µ–Ω—ã `error_log` –∑–∞–ø–∏—Å–∏:**
- `Booking API: Attempting to send confirmation email to guest: ...`
- `Booking API: Guest confirmation email result: ...`
- `Booking API: Attempting to send notification email to host: ...`
- `Booking API: Host notification email result: ...`

**–≠—Ç–∏ –∑–∞–ø–∏—Å–∏ –±—É–¥—É—Ç –≤ –ª–æ–≥–∞—Ö PHP –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ!**

---

### 2. –§–∞–π–ª –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∏—Å–µ–º

**–§–∞–π–ª:** `check-booking-emails.php`

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```
https://new.backtobase.ca/check-booking-emails.php?confirmation_code=BTB-1762222326-0002
```

**–≠—Ç–æ—Ç —Ñ–∞–π–ª:**
- –ù–∞–π–¥–µ—Ç –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –∫–æ–¥—É –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- –ü–æ–∫–∞–∂–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏
- –ü—Ä–æ–≤–µ—Ä–∏—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Mailgun
- –ü–æ–ø—ã—Ç–∞–µ—Ç—Å—è –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–∏—Å—å–º–∞ –≥–æ—Å—Ç—é –∏ —Ö–æ–∑—è–∏–Ω—É
- –ü–æ–∫–∞–∂–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏

---

## üîç –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ–π—á–∞—Å

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ PHP –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ

**–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø–∏—Å–∏:**

```
Booking API: Attempting to send confirmation email to guest: ...
Booking API: Guest confirmation email result: ...
Booking API: Attempting to send notification email to host: ...
Booking API: Host notification email result: ...
Mailgun: Attempting to send email to ...
Mailgun: URL: ...
Mailgun: HTTP Code: ...
Mailgun: Response: ...
```

**–ï—Å–ª–∏ –∑–∞–ø–∏—Å–µ–π –Ω–µ—Ç:**
- –§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
- –ò–ª–∏ `MAILGUN_API_KEY` –ø—É—Å—Ç–æ–π

**–ï—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏:**
- –û–Ω–∏ –±—É–¥—É—Ç –≤ –ª–æ–≥–∞—Ö

---

### –®–∞–≥ 2: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ check-booking-emails.php

1. **–ó–∞–≥—Ä—É–∑–∏—Ç–µ `check-booking-emails.php` –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥**
2. **–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:**
   ```
   https://new.backtobase.ca/check-booking-emails.php?confirmation_code=BTB-1762222326-0002
   ```
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã Mailgun –∫–ª—é—á–∏?
   - –£–¥–∞–µ—Ç—Å—è –ª–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–∏—Å—å–º–∞?
   - –ö–∞–∫–∏–µ –æ—à–∏–±–∫–∏, –µ—Å–ª–∏ –µ—Å—Ç—å?

---

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ª–∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø–∏—Å–µ–º

**–í `booking_api.php` –µ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∞:**

```php
if (!empty(MAILGUN_API_KEY)) {
    // –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–∏—Å—å–º–∞
} else {
    error_log("Booking API: MAILGUN_API_KEY is empty, skipping email sending");
}
```

**–ï—Å–ª–∏ –≤ –ª–æ–≥–∞—Ö –µ—Å—Ç—å "MAILGUN_API_KEY is empty":**
- –ö–ª—é—á –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ `config.php`
- –ò–ª–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ

---

## üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞

**–í –∫–æ–Ω—Å–æ–ª–∏ –Ω–µ –±—ã–ª–æ —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ `booking.js`**

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. `booking.js` –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ Network tab)
2. –°–æ–æ–±—â–µ–Ω–∏—è –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã –∫–æ–Ω—Å–æ–ª–∏)
3. –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–∑–¥–∞–ª–æ—Å—å —á–µ—Ä–µ–∑ fallback (localStorage)

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
- Network tab ‚Üí –µ—Å—Ç—å –ª–∏ –∑–∞–ø—Ä–æ—Å –∫ `booking.js`?
- Network tab ‚Üí –µ—Å—Ç—å –ª–∏ –∑–∞–ø—Ä–æ—Å –∫ `api.php?action=create_booking`?
- Console tab ‚Üí –≤–∫–ª—é—á–∏—Ç–µ –≤—Å–µ —É—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (–Ω–µ —Ç–æ–ª—å–∫–æ errors)

---

## üéØ –ß—Ç–æ –¥–µ–ª–∞—Ç—å —Å–µ–π—á–∞—Å

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ PHP

**–ù–∞–π–¥–∏—Ç–µ –ª–æ–≥–∏ PHP –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–ø–∏—Å–∏:**
- `Booking API: Attempting to send...`
- `Mailgun: Attempting to send...`
- `Mailgun: HTTP Code: ...`

**–°–æ–æ–±—â–∏—Ç–µ, —á—Ç–æ –≤ –ª–æ–≥–∞—Ö!**

---

### 2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ check-booking-emails.php

**–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –∏ –æ—Ç–∫—Ä–æ–π—Ç–µ:**
```
https://new.backtobase.ca/check-booking-emails.php?confirmation_code=BTB-1762222326-0002
```

**–°–æ–æ–±—â–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç!**

---

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ config.php

**–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `config.php` –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã:**
```php
define('MAILGUN_API_KEY', 'YOUR_MAILGUN_API_KEY_HERE');
define('MAILGUN_DOMAIN', 'sandbox2856f0aed70c40a8b13e5a5f4f52c3bc.mailgun.org');
define('MAILGUN_FROM_EMAIL', 'backtobasewellness@gmail.com');
define('MAILGUN_HOST_EMAIL', 'backtobasewellness@gmail.com');
```

---

## ‚ùì –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞ 1: MAILGUN_API_KEY –ø—É—Å—Ç–æ–π

**–°–∏–º–ø—Ç–æ–º:** –í –ª–æ–≥–∞—Ö `MAILGUN_API_KEY is empty`

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `config.php`, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–ª—é—á –Ω–µ –ø—É—Å—Ç–æ–π

---

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º:** –í –ª–æ–≥–∞—Ö –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π `Booking API: Attempting to send...`

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `require_once 'email_service.php';` –µ—Å—Ç—å –≤ `booking_api.php`

---

### –ü—Ä–æ–±–ª–µ–º–∞ 3: Mailgun –æ—Ç–∫–ª–æ–Ω—è–µ—Ç –ø–∏—Å—å–º–∞

**–°–∏–º–ø—Ç–æ–º:** –í –ª–æ–≥–∞—Ö `Mailgun: HTTP Code: 401` –∏–ª–∏ `403`

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API –∫–ª—é—á –∏ –¥–æ–º–µ–Ω –≤ Mailgun Dashboard

---

### –ü—Ä–æ–±–ª–µ–º–∞ 4: Email –Ω–µ –≤ —Å–ø–∏—Å–∫–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö

**–°–∏–º–ø—Ç–æ–º:** –í –ª–æ–≥–∞—Ö `Mailgun: HTTP Code: 400` —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º –æ –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–º email

**–†–µ—à–µ–Ω–∏–µ:** –î–ª—è Sandbox Domain –¥–æ–±–∞–≤—å—Ç–µ email –≤ —Å–ø–∏—Å–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π

---

## üéØ –ò—Ç–æ–≥

**–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ, –Ω–æ –ø–∏—Å—å–º–∞ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è.**

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ PHP –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `check-booking-emails.php` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Mailgun –≤ `config.php`

**–°–æ–æ–±—â–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏!** üöÄ



