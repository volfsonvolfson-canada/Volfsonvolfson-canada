# Инструкция по настройке синхронизации с Airbnb

## Что вам нужно предоставить

### 1. iCal URL от Airbnb для каждой комнаты

Для получения iCal URL выполните следующие шаги:

#### Шаг 1: Войдите в Airbnb
1. Откройте https://www.airbnb.com
2. Войдите в свой аккаунт хозяина

#### Шаг 2: Перейдите в настройки календаря
1. Нажмите на ваш профиль (в правом верхнем углу)
2. Выберите **"Хостинг"** (Host) → **"Список объявлений"** (Listings)
3. Выберите объявление (room/property)
4. Перейдите в раздел **"Календарь"** (Calendar)

#### Шаг 3: Найдите ссылку для синхронизации
1. В разделе календаря найдите опцию **"Синхронизировать календари"** (Sync calendars) или **"Экспорт календаря"** (Export calendar)
2. Найдите раздел **"Экспорт календаря"** или **"Export calendar"**
3. Вы увидите ссылку вида:
   ```
   https://www.airbnb.com/calendar/ical/12345678.ics?user_id=12345678&listing_id=12345678&s=...
   ```
   или
   ```
   https://calendar.google.com/calendar/ical/.../basic.ics
   ```

#### Шаг 4: Скопируйте iCal URL
1. Скопируйте полный URL (начинается с `http://` или `https://`)
2. Сохраните его для соответствующей комнаты

### 2. Соответствие комнат

Вам нужно указать, какая комната на вашем сайте соответствует какому Airbnb объявлению:

**Пример:**
- "Basement — Queen" → iCal URL #1 (если эта комната соответствует Airbnb listing #1)
- "Ground floor — Queen bed" → iCal URL #2 (если эта комната соответствует Airbnb listing #2)
- "Ground floor — Twin beds" → iCal URL #2 (если это та же комната, что и выше)
- "Second floor (entire) — Queen bed" → iCal URL #3 (если эта комната соответствует Airbnb listing #3)

**Примечание:** 
- Если у вас несколько комнат на Airbnb, нужен iCal URL для каждой
- Если несколько комнат на сайте соответствуют одному Airbnb объявлению, используйте тот же URL

### 3. Что нужно предоставить

Пришлите список в следующем формате:

```
Комната на сайте: "Basement — Queen"
iCal URL: https://www.airbnb.com/calendar/ical/12345678.ics?user_id=12345678&listing_id=12345678&s=...

Комната на сайте: "Ground floor — Queen bed"
iCal URL: https://www.airbnb.com/calendar/ical/98765432.ics?user_id=98765432&listing_id=98765432&s=...

Комната на сайте: "Second floor (entire) — Queen bed"
iCal URL: https://www.airbnb.com/calendar/ical/45678901.ics?user_id=45678901&listing_id=45678901&s=...
```

## Как это будет работать

После настройки:
1. **Автоматическая синхронизация**: Система будет периодически (ежедневно/ежечасно) синхронизироваться с календарем Airbnb
2. **Проверка доступности**: При создании бронирования система проверит:
   - Не занято ли в Airbnb
   - Нет ли заблокированных дат в базе
   - Нет ли существующих бронирований
3. **Предотвращение двойного бронирования**: Если дата занята в Airbnb, она будет недоступна на вашем сайте
4. **Ручная синхронизация**: В админ-панели можно запустить синхронизацию вручную

## Важные замечания

⚠️ **Безопасность iCal URL:**
- iCal URL содержит идентификаторы вашего Airbnb аккаунта
- Не публикуйте эти URL публично
- Они будут храниться только в конфигурации на сервере

⚠️ **Обновление URL:**
- Если вы изменили настройки календаря в Airbnb, URL может измениться
- Нужно будет обновить URL в конфигурации

⚠️ **Синхронизация:**
- Первая синхронизация может занять несколько минут
- Последующие синхронизации быстрее (только обновление изменений)
- Рекомендуется синхронизировать хотя бы раз в день

## Вопросы

Если у вас возникли вопросы или проблемы с получением iCal URL:
1. Проверьте, что у вас есть права хостинга на Airbnb
2. Убедитесь, что календарь экспортирован правильно
3. Свяжитесь с поддержкой Airbnb, если URL не работает



